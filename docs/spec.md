# 当アプリケーションの設計について

- Created 2022/01/20
- Updated 2022/01/20

## プロジェクト概要

- 開発時に利用するライブラリの設定ファイル群は除外

.
├── build ... 生成時に作成されるディレクトリ
│ └── src
│     ├── index.js ... 動作確認、エントリファイル
│     └── wallet.js ... メインファイル
├── docs
│ ├── assets
│ │ └── logo.png
│ └── `spec.md` ... 当説明資料
├── src
│ ├── index.ts
│ └── wallet.ts
└── test
   └── wallet.test.ts ... テストコード

## メインファイルの設計意図

1. wallet のインスタンスを生成する.
2. 現在の残高を提供する.
3. 指定した額を入金する.
4. 指定した額を出金する.
5. 入出金の履歴を提供する.

### 各順番の詳細

> 1. wallet のインスタンスを生成する.

walletクラスの初期設定を定義する.
クラスを生成時に引数で渡した数値を初期値として設定する.
クラスを生成時に履歴を空にする.

> 2. 現在の残高を提供する.

クラスのメンバー変数の残高を返却する.

> 3. 指定した額を入金する.
> 4. 指定した額を出金する.

会計処理をプライベートメソッドで定義した.
会計処理の計算方法や、手数料などの変更時には、このメソッドを変更することで、対応ができるようになる.

会計処理の種類を「入金」「出金」以外が出てくることを想定して定義している.
今後増えてきた場合は、会計処理の種類を判断してプライベートメソッドに定義して呼び出すことができるようにしてある。
現在は、「入金」「出金」のどちらかのみなので当プライベートメソッドに処理を記載している.

エラーメッセージについては、アプリケーション利用者に対して操作の結果の通知と、操作の案内を記載した。

背景としては、通知と案内を記載することで次の操作の示唆を示すようにしている.

入力値の妥当性確認として正の数かどうかを正規表現で確認するようにした.

> 5. 入出金の履歴を提供する.

タイムゾーンを日本に設定して日時を出力するようにした.
操作時の金額、手数料、操作後の残高を出力するようにした.
JSON形式の配列で出力することで、出力した文字列を加工しやすくした.
また、履歴が新しい順ということなので配列内の要素を逆にした.

### テストについて

- 機能が実装されていることを確認した.
- CIでレポート確認ができるように`junit-xml`を生成するようにした.
- new Date()を固定するために `Object.defineProperty()`を利用して日時を固定化した.
